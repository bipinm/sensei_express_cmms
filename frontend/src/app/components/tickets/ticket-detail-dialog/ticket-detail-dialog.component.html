<h2 mat-dialog-title>
  <div class="dialog-title">
    <mat-icon>confirmation_number</mat-icon>
    <div>
      <div class="ticket-id">{{ ticket.ticketId }}</div>
      <div class="subtitle">{{ ticket.type }} · Priority {{ ticket.priority }}</div>
    </div>
  </div>
</h2>

<mat-dialog-content>
  <div class="status-row">
    <mat-chip color="primary" selected>Status: {{ ticket.status.replace('_', ' ') }}</mat-chip>
    <mat-chip color="accent" selected>Priority: {{ ticket.priority }}</mat-chip>
    <mat-chip>Type: {{ ticket.type }}</mat-chip>
  </div>

  <mat-tab-group>
    <mat-tab label="Overview">
      <section class="overview">
        <div class="info-grid">
          <div>
            <span class="label">Location</span>
            <span class="value">{{ ticket.location || 'Not specified' }}</span>
          </div>
          <div>
            <span class="label">Created</span>
            <span class="value">{{ ticket.createdAt ? (ticket.createdAt | date : 'medium') : '—' }}</span>
          </div>
          <div>
            <span class="label">Updated</span>
            <span class="value">{{ ticket.updatedAt ? (ticket.updatedAt | date : 'medium') : '—' }}</span>
          </div>
        </div>

        <div class="text-block">
          <h3>Description</h3>
          <p>{{ ticket.description }}</p>
        </div>

        <div class="text-block" *ngIf="ticket.notes">
          <h3>Notes</h3>
          <p>{{ ticket.notes }}</p>
        </div>
      </section>
    </mat-tab>

    <mat-tab label="Attachments">
      <ng-container *ngIf="attachments.length; else emptyAttachments">
        <mat-list>
          <mat-list-item *ngFor="let file of attachments">
            <mat-icon matListItemIcon>attach_file</mat-icon>
            <div matListItemTitle>{{ file.name }}</div>
            <div matListItemLine>
              {{ file.type || 'File' }}
              <span *ngIf="file.notes"> · {{ file.notes }}</span>
            </div>
            <a
              mat-stroked-button
              color="primary"
              *ngIf="file.url"
              [href]="file.url"
              target="_blank"
              rel="noopener"
              >Open</a
            >
          </mat-list-item>
        </mat-list>
      </ng-container>
      <ng-template #emptyAttachments>
        <p class="empty-state">No attachments linked to this ticket.</p>
      </ng-template>
    </mat-tab>
  </mat-tab-group>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="close()">Close</button>
</mat-dialog-actions>
